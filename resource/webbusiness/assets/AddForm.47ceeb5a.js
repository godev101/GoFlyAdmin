import{p as W,_ as Y}from"./index.47cdf61a.js";/* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css                *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css               *//* empty css               *//* empty css               */import{d as J,e as m,c as Q,u as T,aS as q,aL as k,C as _,aE as B,aH as u,G as s,F as X,aI as a,bA as Z,aO as D,aN as f,bi as x,D as R,aK as z,aJ as O,aF as G,bB as ee,bU as ue,b7 as ae,b_ as te,cc as le,ba as oe,bz as ne,bN as ie,aW as se,bL as re,bM as de,aY as pe,bb as me,c4 as fe,bc as Fe,b2 as ce,b3 as Ee}from"./arco.9680cdc2.js";import{B as _e,u as ge}from"./index.cb070d16.js";import{u as ve}from"./loading.351b94a0.js";import{a as K,g as he}from"./generatecode.55be79ad.js";import{g as Be}from"./rule.26b64704.js";import{I as De}from"./IconPicker.7350328a.js";import{I as be}from"./Icon.9698649f.js";import"./chart.1da8855c.js";import"./vue.780a5d54.js";/* empty css                *//* empty css                */const Ce=J({name:"AddForm",components:{BasicModal:_e,IconPicker:De,Icon:be},emits:["success"],setup(e,{emit:n}){const F=m([]),S=m([]),g=m([]),b=m(!1),r=m(1),d=m(620),C=m(620),A=m(),l=m({id:0,pid:"",comment:"",icon:"",tablename:"",engine:"",routePath:"",routeName:"",component:"",api_path:"",api_filename:"",fields:[],is_install:0,tpl_type:"list",cate_tablename:""}),$=m(),p=m(""),y=m(),[c,{setModalProps:v,closeModal:V}]=ge(async i=>{var h;(h=A.value)==null||h.resetFields(),r.value=1,b.value=!!(i!=null&&i.isUpdate);const o=await Be({});if(o){F.value=o;const E=F.value.find(P=>P.id==i.record.pid);E&&(p.value=E.routePath),i.record.tpl_type=="cate"&&(g.value=await K({id:l.value.id}))}else F.value=[];T(b)&&(l.value=W(i.record),l.value.fields&&(l.value.fields=l.value.fields.split(",")),i.record.pid==0&&(l.value.pid=""),I(i),y.value=i),setTimeout(async()=>{S.value=await he({tablename:i.record.tablename})},1e3)}),w=i=>{const o=F.value.find(h=>h.id==i);o&&(p.value=o.routePath),I(y.value)},I=i=>{const o=i.record.tablename.split("_"),E=(window==null?void 0:window.globalConfig.Root_url).split("/");if(o&&o.length==3){l.value.cate_tablename=o[0]+"_"+o[1]+"_cate";const P=F.value.find(j=>j.routePath=="/"+o[1]);P&&(l.value.pid=P.id)}o&&o.length==3?(l.value.routePath=`${o[2]}`,l.value.routeName=`${o[2]}`,l.value.component=`${p.value?p.value.split("/")[1]:o[1]}/${o[2]}/index`,l.value.api_path=`${E[E.length-1]}/${p.value?p.value.split("/")[1]:o[1]}`,l.value.api_filename=o[2]+".go"):(l.value.routePath=`${o[1]}`,l.value.routeName=`${o[1]}`,l.value.component=`${p.value?p.value.split("/")[1]:"xx"}/${o[1]}/index`,l.value.api_path=`${E[E.length-1]}/${p.value?p.value.split("/")[1]:"xx"}`,l.value.api_filename=o[1]+".go")},U=Q(()=>(T(b),"\u540E\u53F0\u4EE3\u7801\u751F\u6210\u7BA1\u7406")),{loading:L,setLoading:M}=ve();return{registerModal:c,getTitle:U,handleSubmit:async()=>{{q.error({content:"Go\u5C5E\u4E8E\u7F16\u8BD1\u8BED\u8A00\uFF0C\u751F\u4EA7\u73AF\u5883\u65E0\u6CD5\u4FEE\u6539\u4EE3\u7801\uFF0C\u8BF7\u60A8\u5728\u5F00\u53D1\u73AF\u5883\u4F7F\u7528\uFF01",id:"upStatus",duration:2e3});return}},formRef:A,loading:L,formData:l,OYoptions:[{label:"\u5426",value:0},{label:"\u662F",value:1}],tapList:[{id:1,name:"\u751F\u6210\u4EE3\u7801"},{id:2,name:"\u751F\u6210\u8BB0\u5F55"}],handleIcon:i=>{l.value.icon=i},activeKey:r,modelHeight:d,editorRef:$,handleChangeMenu:w,onHeightChange:i=>{C.value=i},windHeight:C,parntList:F,handleUninstall:async()=>{{q.error({content:"Go\u5C5E\u4E8E\u7F16\u8BD1\u8BED\u8A00\uFF0C\u751F\u4EA7\u73AF\u5883\u65E0\u6CD5\u4FEE\u6539\u4EE3\u7801\uFF0C\u8BF7\u60A8\u5728\u5F00\u53D1\u73AF\u5883\u4F7F\u7528\uFF01",id:"upStatus",duration:2e3});return}},fieldList:S,handelTplType:async i=>{i=="cate"&&(!g.value||g.value.length==0)&&(g.value=await K({id:l.value.id}))},tablenameList:g}}});const N=e=>(ce("data-v-3996c2a3"),e=e(),Ee(),e),Ae={class:"tabs-content"},ye={class:"content_box"},Ve={class:"gcodebox"},we={class:"textbox"},Ie={class:"textbox"},Pe=N(()=>s("div",null,"\u5982\u679C\u662F\u6839\u76EE\u5F55\u6216\u8BBF\u95EE\u8DEF\u7531\u4E0D\u52A0\u4E0A\u7EA7\u76EE\u5F55\u8BF7\u5728\u540D\u79F0\u524D\u52A0/",-1)),ke=N(()=>s("span",{style:{width:"50px","text-align":"center"}},"\u6587\u4EF6",-1)),Se={class:"textbox"},$e={class:"btnbox"},Ue=N(()=>s("div",{class:"tigmsg"},[s("div",null,"\u6CE8\u610F\uFF1A"),s("span",null,"\u751F\u6210\u4EE3\u7801\u662F\u60A8\u8981\u518D\u540E\u7AEFconfig/settings.yml\u914D\u7F6E\u4E2D\u4FEE\u6539\u524D\u7AEF\u4EE3\u7801\u6240\u5728\u7684\u76EE\u5F55vueobjroot=D:/Project/develop/vue/gofly_base/gofly_business(\u4FEE\u6539\u4F60\u524D\u7AEF\u4EE3\u7801\u8DEF\u5F84)")],-1));function Le(e,n,F,S,g,b){const r=ae,d=te,C=le,A=oe,H=k("Icon"),l=k("icon-apps"),$=k("IconPicker"),p=ne,y=ie,c=se,v=re,V=de,w=pe,I=me,U=fe,L=Fe,M=k("BasicModal");return _(),B(M,ue(e.$attrs,{onRegister:e.registerModal,footer:!1,isPadding:!1,loading:e.loading,width:"1000px",onHeightChange:e.onHeightChange,minHeight:e.modelHeight,title:e.getTitle,onOk:e.handleSubmit}),{default:u(()=>[s("div",{class:"addFormbox",style:X({"min-height":`${e.windHeight}px`})},[s("div",Ae,[s("div",ye,[a(L,{ref:"formRef",model:e.formData,"auto-label-width":""},{default:u(()=>[Z(s("div",Ve,[a(U,{gutter:16},{default:u(()=>[a(d,{span:12},{default:u(()=>[a(r,{field:"comment",label:"\u8868\u8BF4\u660E:","validate-trigger":"input"},{default:u(()=>[s("span",we,D(e.formData.comment),1)]),_:1})]),_:1}),a(d,{span:12},{default:u(()=>[a(r,{field:"tablename",label:"\u8868\u540D:","validate-trigger":"input"},{default:u(()=>[s("span",Ie,D(e.formData.tablename),1)]),_:1})]),_:1}),a(d,{span:12},{default:u(()=>[a(r,{label:"\u4E0A\u7EA7\u83DC\u5355",field:"pid",style:{"margin-bottom":"15px"},rules:[{required:!0,message:"\u8BF7\u586B\u4E0A\u7EA7\u83DC\u5355"}]},{extra:u(()=>[s("div",null,[f("\u82E5\u8981\u7ED1\u5B9A\u5230\u65B0\u7684\u76EE\u5F55\u8BF7\u5230"),a(A,{href:"/system/rule"},{default:u(()=>[f("\u83DC\u5355\u7BA1\u7406(dev)")]),_:1}),f("\u6DFB\u52A0\u65B0\u76EE\u5F55")])]),default:u(()=>[a(C,{placeholder:"\u9009\u62E9\u4E0A\u7EA7\u83DC\u5355",data:e.parntList,onChange:e.handleChangeMenu,fieldNames:{key:"id",title:"title",children:"children"},modelValue:e.formData.pid,"onUpdate:modelValue":n[0]||(n[0]=t=>e.formData.pid=t)},null,8,["data","onChange","modelValue"])]),_:1})]),_:1}),a(d,{span:12},{default:u(()=>[a(r,{label:"\u56FE\u6807",field:"icon",style:{"margin-bottom":"15px"}},{default:u(()=>[a(y,{modelValue:e.formData.icon,"onUpdate:modelValue":n[1]||(n[1]=t=>e.formData.icon=t),placeholder:"\u9009\u62E9\u56FE\u6807/\u586B\u5199","search-button":""},x({"button-icon":u(()=>[a(p,{position:"br",trigger:"click"},{content:u(()=>[a($,{onChange:e.handleIcon},null,8,["onChange"])]),default:u(()=>[a(l,{size:23})]),_:1})]),_:2},[e.formData.icon?{name:"prefix",fn:u(()=>[a(H,{icon:e.formData.icon},null,8,["icon"])]),key:"0"}:void 0]),1032,["modelValue"])]),_:1})]),_:1}),a(d,{span:12},{default:u(()=>[a(r,{field:"routePath",label:"\u8DEF\u7531Path","validate-trigger":"input",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u8DEF\u7531\u8DEF\u7531\uFF08path\uFF09"}]},{extra:u(()=>[Pe]),default:u(()=>[a(c,{modelValue:e.formData.routePath,"onUpdate:modelValue":n[2]||(n[2]=t=>e.formData.routePath=t),placeholder:"\u8BF7\u586B\u8DEF\u7531\uFF08path\uFF09"},null,8,["modelValue"])]),_:1})]),_:1}),a(d,{span:12},{default:u(()=>[a(r,{field:"routeName",label:"\u8DEF\u7531name","validate-trigger":"input",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u8DEF\u7531\u8DEF\u7531\uFF08name\uFF09"}]},{default:u(()=>[a(c,{modelValue:e.formData.routeName,"onUpdate:modelValue":n[3]||(n[3]=t=>e.formData.routeName=t),placeholder:"\u8BF7\u586B\u8DEF\u7531\uFF08name\uFF09"},null,8,["modelValue"])]),_:1})]),_:1}),a(d,{span:10},{default:u(()=>[a(r,{field:"component",label:"\u524D\u7AEF\u7EC4\u4EF6\u8DEF\u5F84","validate-trigger":"input",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u524D\u7AEF\u7EC4\u4EF6\u8DEF\u5F84"}]},{default:u(()=>[a(c,{modelValue:e.formData.component,"onUpdate:modelValue":n[4]||(n[4]=t=>e.formData.component=t),placeholder:"\u8BF7\u586B\u524D\u7AEF\u7EC4\u4EF6\u8DEF\u5F84"},null,8,["modelValue"])]),_:1})]),_:1}),a(d,{span:14},{default:u(()=>[a(r,{field:"api_path",label:"\u540E\u53F0\u4EE3\u7801\u8DEF\u5F84","validate-trigger":"input",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u540E\u53F0\u4EE3\u7801\u8DEF\u5F84"}]},{extra:u(()=>[s("div",null,[f("\u540E\u53F0\u4E1A\u52A1\u4EE3\u7801 "),s("span",Se,D(e.formData.api_path+"/"+e.formData.api_filename),1),f("\u6587\u4EF6\u4E0B")])]),default:u(()=>[a(c,{modelValue:e.formData.api_path,"onUpdate:modelValue":n[5]||(n[5]=t=>e.formData.api_path=t),placeholder:"\u8BF7\u586B\u540E\u53F0\u4EE3\u7801\u8DEF\u5F84"},null,8,["modelValue"]),ke,a(c,{modelValue:e.formData.api_filename,"onUpdate:modelValue":n[6]||(n[6]=t=>e.formData.api_filename=t),style:{width:"190px"},placeholder:"\u8BF7\u586B\u540E\u53F0\u4EE3\u7801\u6587\u4EF6"},null,8,["modelValue"])]),_:1})]),_:1}),a(d,{span:24},{default:u(()=>[a(r,{field:"fields",label:"\u67E5\u8BE2\u5217\u8868\u5B57\u6BB5","validate-trigger":"input",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u67E5\u8BE2\u5217\u8868\u5B57\u6BB5"}]},{default:u(()=>[a(V,{modelValue:e.formData.fields,"onUpdate:modelValue":n[7]||(n[7]=t=>e.formData.fields=t),placeholder:"\u9009\u62E9\u67E5\u8BE2\u5217\u8868\u5B57\u6BB5",multiple:"","max-tag-count":12,"allow-clear":""},{default:u(()=>[(_(!0),R(z,null,O(e.fieldList,t=>(_(),B(v,{value:t.value},{default:u(()=>[f(D(t.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(d,{span:12},{default:u(()=>[a(r,{field:"tpl_type",label:"\u6A21\u677F\u7C7B\u578B","validate-trigger":"input",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6A21\u677F\u7C7B\u578B"}]},{default:u(()=>[a(V,{onChange:e.handelTplType,modelValue:e.formData.tpl_type,"onUpdate:modelValue":n[8]||(n[8]=t=>e.formData.tpl_type=t),placeholder:"\u9009\u62E9\u6A21\u677F\u7C7B\u578B","allow-clear":""},{default:u(()=>[a(v,{value:"list"},{default:u(()=>[f("\u6570\u636E\u5217\u8868")]),_:1}),a(v,{value:"contentlist"},{default:u(()=>[f("\u5BCC\u6587\u672C\u6570\u636E\u5217\u8868")]),_:1}),a(v,{value:"contentcatelist"},{default:u(()=>[f("\u5BCC\u6587\u672C\u6570\u636E\u5173\u8054\u5206\u7C7B")]),_:1})]),_:1},8,["onChange","modelValue"])]),_:1})]),_:1}),e.formData.tpl_type=="contentcatelist"?(_(),B(d,{key:0,span:12},{default:u(()=>[a(r,{field:"cate_tablename",label:"\u5206\u7C7B\u7684\u6570\u636E\u5E93","validate-trigger":"input",rules:[{required:!0,message:"\u8BF7\u9009\u5206\u7C7B\u7684\u6570\u636E\u5E93"}]},{default:u(()=>[a(V,{modelValue:e.formData.cate_tablename,"onUpdate:modelValue":n[9]||(n[9]=t=>e.formData.cate_tablename=t),placeholder:"\u9009\u62E9\u5206\u7C7B\u7684\u6570\u636E\u5E93","allow-clear":""},{default:u(()=>[(_(!0),R(z,null,O(e.tablenameList,t=>(_(),B(v,{value:t.value},{default:u(()=>[f(D(t.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1})):G("",!0),a(d,{span:24},{default:u(()=>[s("div",$e,[a(I,null,{default:u(()=>[a(w,{onClick:e.handleSubmit,"html-type":"submit",size:"large",type:"primary",shape:"round",style:{width:"200px","margin-top":"15px"}},{default:u(()=>[f("\u5F00\u59CB\u751F\u6210")]),_:1},8,["onClick"]),e.formData.is_install==1?(_(),B(w,{key:0,onClick:e.handleUninstall,size:"large",shape:"round",style:{width:"200px","margin-top":"15px"}},{default:u(()=>[f("\u5378\u8F7D\u4EE3\u7801\u53CA\u83DC\u5355")]),_:1},8,["onClick"])):G("",!0)]),_:1})])]),_:1})]),_:1}),Ue],512),[[ee,e.activeKey==1]])]),_:1},8,["model"])])])],4)]),_:1},16,["onRegister","loading","onHeightChange","minHeight","title","onOk"])}const pu=Y(Ce,[["render",Le],["__scopeId","data-v-3996c2a3"]]);export{pu as default};
