import{u as oe,_ as se}from"./index.4e7f69e1.js";/* empty css                *//* empty css                *//* empty css               *//* empty css               *//* empty css              *//* empty css                *//* empty css               *//* empty css                *//* empty css                *//* empty css                *//* empty css                *//* empty css                *//* empty css               *//* empty css                *//* empty css                *//* empty css               *//* empty css                *//* empty css               */import{c as L,d as ce,e as d,w as le,o as re,n as z,aL as x,C as k,D as A,aI as t,aH as n,aN as m,aO as C,G as w,aK as ie,aJ as ue,u as r,aE as de,E as pe,bP as me,aS as l,bb as _e,bQ as he,aX as fe,bv as ve,bw as ge,bx as be,bR as ye,aW as xe,bS as Ce,bT as we,bU as De,bV as Fe}from"./arco.f2539126.js";import{u as Ie}from"./loading.0b400085.js";import{A as ke,g as Ee,u as Be,d as Se}from"./AddForm.cd02f5a8.js";import{c as M}from"./cloneDeep.188a8ec5.js";import{a as Te}from"./index.d16c415d.js";import{I as D}from"./Icon.48da78a9.js";import{S as Ne}from"./sortable.esm.a99254e8.js";import{t as ze}from"./common.d93fd641.js";import"./chart.87fd2a0d.js";import"./vue.0c455acb.js";/* empty css               *//* empty css               *//* empty css               */import"./IconPicker.65a498b6.js";const Ae=L(()=>[{title:"\u83DC\u5355\u540D\u79F0",dataIndex:"title",slotName:"title"},{title:"\u56FE\u6807",dataIndex:"icon",slotName:"icon",align:"center"},{title:"\u6743\u9650\u6807\u8BC6",dataIndex:"permission",slotName:"permission"},{title:"\u7EC4\u4EF6",dataIndex:"component",slotName:"component"},{title:"\u6392\u5E8F",dataIndex:"orderNo",slotName:"orderNo",align:"center"},{title:"\u72B6\u6001",dataIndex:"status",slotName:"status",align:"center"},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createtime",slotName:"createtime",align:"center"},{title:"\u64CD\u4F5C",dataIndex:"operations",slotName:"operations",align:"center"}]),Me={class:"container"},Le={class:"action-icon"},Ve=["innerHTML"],$e={name:"Rule"},Re=ce({...$e,setup(Ue){const{t:_}=oe(),[V,{openModal:E}]=Te(),$=L(()=>[{name:_("searchTable.size.mini"),value:"mini"},{name:_("searchTable.size.small"),value:"small"},{name:_("searchTable.size.medium"),value:"medium"},{name:_("searchTable.size.large"),value:"large"}]),{loading:R,setLoading:B}=Ie(!0),u=d([]),h=d([]),U=d([]),F=d("large"),I=d(),f=async()=>{B(!0);try{const e=await Ee({});u.value=e,z(()=>{I.value.expandAll()})}catch{}finally{B(!1)}},W=()=>{f()};f();const Y=(e,a)=>{F.value=e};le(()=>Ae.value,e=>{h.value=M(e),h.value.forEach((a,s)=>{a.checked=!0}),U.value=M(h.value)},{deep:!0,immediate:!0});const H=()=>{E(!0,{isUpdate:!1,record:null})},O=async e=>{E(!0,{isUpdate:!0,record:e})},P=async()=>{f()},j=async e=>{try{l.loading({content:"\u66F4\u65B0\u72B6\u6001\u4E2D",id:"upStatus"}),await Be({id:e.id,status:e.status})&&l.success({content:"\u66F4\u65B0\u72B6\u6001\u6210\u529F",id:"upStatus"})}catch{l.clear("top")}},q=async e=>{try{l.loading({content:"\u5220\u9664\u4E2D",id:"upStatus"}),await Se({ids:[e.id]})&&(f(),l.success({content:"\u5220\u9664\u6210\u529F",id:"upStatus"}))}catch{l.clear("top")}},G=()=>{const e=I.value.$el.querySelector(".arco-table-element tbody");Ne.create(e,{handle:".dragIcon",dataIdAttr:"data-id",onEnd(a){const{newIndex:s,oldIndex:c}=a;let v=d([]);for(var p=0;p<u.value.length;p++)v.value.push(u.value[p].id);let i=S(u.value),g=i[c];i[c]=i[s],i[s]=g;let b=T(u.value);J(i,g,b[c])}})},S=e=>{let a=[];return e.forEach(s=>{if(s.children){let c=S(s.children);a.push(s.id),a.push(...c)}else a.push(s.id)}),a},T=e=>{let a=[];return e.forEach(s=>{if(s.children){let c=T(s.children);a.push(s.pid),a.push(...c)}else a.push(s.pid)}),a},J=async(e,a,s)=>{if(!(!e||!a))try{l.loading({content:"\u66F4\u65B0\u6392\u5E8F\u4E2D",id:"tableWeigh"}),await ze({ids:e,changeid:a,field:"orderNo",table:"business_auth_rule",prikey:"id",pid:s,orderway:"asc"})&&l.success({content:"\u66F4\u65B0\u6392\u5E8F\u6210\u529F",id:"tableWeigh"})}catch{l.clear("top")}};return re(()=>{z(()=>{G()})}),(e,a)=>{const s=x("Breadcrumb"),c=_e,v=he,p=x("icon-plus"),i=fe,g=x("icon-refresh"),b=ve,K=x("icon-line-height"),Q=ge,X=be,Z=ye,ee=xe,N=Ce,te=we,ae=De,ne=Fe;return k(),A("div",Me,[t(s,{items:["menu.system","menu.system.rule"]},null,8,["items"]),t(ne,{class:"general-card onelineCard"},{default:n(()=>[t(Z,{style:{"margin-bottom":"10px"}},{default:n(()=>[t(v,{span:12},{default:n(()=>[t(c)]),_:1}),t(v,{span:12,style:{"text-align":"right"}},{default:n(()=>[t(c,null,{default:n(()=>[t(i,{type:"primary",onClick:H},{icon:n(()=>[t(p)]),default:n(()=>[m(" "+C(e.$t("searchTable.operation.create")),1)]),_:1}),t(b,{content:e.$t("searchTable.actions.refresh")},{default:n(()=>[w("div",{class:"action-icon",onClick:W},[t(g,{size:"18"})])]),_:1},8,["content"]),t(X,{onSelect:Y},{content:n(()=>[(k(!0),A(ie,null,ue(r($),o=>(k(),de(Q,{key:o.value,value:o.value,class:pe({active:o.value===F.value})},{default:n(()=>[w("span",null,C(o.name),1)]),_:2},1032,["value","class"]))),128))]),default:n(()=>[t(b,{content:e.$t("searchTable.actions.density")},{default:n(()=>[w("div",Le,[t(K,{size:"18"})])]),_:1},8,["content"])]),_:1})]),_:1})]),_:1})]),_:1}),t(ae,{"row-key":"id",loading:r(R),pagination:!1,columns:h.value,data:u.value,bordered:{wrapper:!0,cell:!0},size:F.value,"default-expand-all-rows":!0,ref_key:"artable",ref:I},{title:n(({record:o})=>[w("span",{innerHTML:o.spacer,style:{"padding-right":"5px",color:"var(--color-neutral-4)"}},null,8,Ve),m(C(o.title),1)]),icon:n(({record:o})=>[t(r(D),{icon:o.icon,size:20},null,8,["icon"])]),createtime:n(({record:o})=>[m(C(r(me)(o.createtime*1e3).format("YYYY-MM-DD")),1)]),status:n(({record:o})=>[t(ee,{type:"round",modelValue:o.status,"onUpdate:modelValue":y=>o.status=y,"checked-value":0,"unchecked-value":1,onChange:y=>j(o)},{checked:n(()=>[m(" \u5F00 ")]),unchecked:n(()=>[m(" \u5173 ")]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),operations:n(({record:o})=>[t(r(D),{icon:"icon-drag-dot-vertical",class:"iconbtn dragIcon",size:18,color:"#0960bd"}),t(N,{direction:"vertical"}),t(r(D),{icon:"svgfont-bianji1",class:"iconbtn",onClick:y=>O(o),size:18,color:"#0960bd"},null,8,["onClick"]),t(N,{direction:"vertical"}),t(te,{content:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onOk:y=>q(o)},{default:n(()=>[t(r(D),{icon:"svgfont-icon7",class:"iconbtn",size:18,color:"#ed6f6f"})]),_:2},1032,["onOk"])]),_:1},8,["loading","columns","data","size"])]),_:1}),t(ke,{onRegister:r(V),onSuccess:P},null,8,["onRegister"])])}}});const yt=se(Re,[["__scopeId","data-v-3dbba3f0"]]);export{yt as default};
