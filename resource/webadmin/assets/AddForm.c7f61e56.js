import{m as p,T as z,u as q,n as O,_ as T}from"./index.4e7f69e1.js";/* empty css               *//* empty css               *//* empty css                *//* empty css               *//* empty css                *//* empty css               *//* empty css               *//* empty css               *//* empty css               */import{d as $,e as B,c as j,u as E,aS as k,aL as U,C as h,aE as H,aH as o,aI as a,G as F,D as L,bW as N,E as W,b6 as G,b7 as Q,bQ as Y,bL as J,bR as K,c2 as X,bM as Z,bc as x}from"./arco.f2539126.js";import{B as ee,u as ae}from"./index.d16c415d.js";import{u as oe}from"./loading.0b400085.js";import{I as ue}from"./IconPicker.65a498b6.js";import{I as le}from"./Icon.48da78a9.js";import{u as te}from"./common.d93fd641.js";function ze(e){return p.get({url:"/business/bizuser/get_list",params:e},{errorMessageMode:"none"})}function se(){return p.get({url:"/business/bizuser/get_role"},{errorMessageMode:"none"})}function re(e){return e.password&&(e=Object.assign({},e,{password:z.exports(e.password)})),p.post({url:"/business/bizuser/save",params:e},{errorMessageMode:"message"})}function ne(e){return p.post({url:"/business/bizuser/isaccountexist",params:e},{errorMessageMode:"message",isTransformResponse:!1})}function qe(e){return p.post({url:"/business/bizuser/upStatus",params:e},{errorMessageMode:"message"})}function Oe(e){return p.delete({url:"/business/bizuser/del",params:e},{errorMessageMode:"message"})}const de=$({name:"AddForm",components:{BasicModal:ee,IconPicker:ue,Icon:le},emits:["success"],setup(e,{emit:u}){const{t:R}=q(),f=B(!1),D=B([]),V=B(),n={id:0,name:"",roleid:[],nickname:"",username:"",password:"",avatar:"",tel:"",mobile:"",email:"",address:"",city:"",remark:"",company:""},t=B(n),s=B(""),[C,{setModalProps:_,closeModal:M}]=ae(async r=>{var g;(g=V.value)==null||g.resetFields(),_({confirmLoading:!1});const d=await se();d?D.value=d:D.value=[],f.value=!!(r!=null&&r.isUpdate),E(f)?(s.value=r.record.component,t.value=O(r.record)):t.value=n}),w=j(()=>E(f)?"\u7F16\u8F91\u7BA1\u7406\u8D26\u53F7":"\u65B0\u589E\u7BA1\u7406\u8D26\u53F7"),{loading:A,setLoading:c}=oe();return{registerModal:C,getTitle:w,handleSubmit:async()=>{var r;try{await((r=V.value)==null?void 0:r.validate())||(c(!0),!E(f)&&t.value.password==""&&(t.value.password="123456"),k.loading({content:"\u66F4\u65B0\u4E2D",id:"upStatus"}),await re(E(t)),k.success({content:"\u66F4\u65B0\u6210\u529F",id:"upStatus"}),M(),u("success"),c(!1))}catch{c(!1),k.clear("top")}},formRef:V,loading:A,formData:t,roleList:D,t:R,OYoptions:[{label:"\u5426",value:0},{label:"\u662F",value:1}],onChange:r=>{console.log("fileList",r)},customRequest:r=>{const d=new AbortController;return async function(){const{onProgress:m,onError:v,onSuccess:Ve,fileItem:y}=r;m(20);const P=i=>{let b;i.total>0&&(b=i.loaded/i.total*100),m(parseInt(String(b),10),i)};try{const i=(y==null?void 0:y.name)||"",b=await te({name:"file",file:y.file,filename:i,data:{cid:0}},P);b&&(t.value.avatar=b.url)}catch(i){v(i)}}(),{abort(){d.abort()}}},usernameRules:[{validator:(r,d)=>new Promise(async g=>{if(!r)d("\u8BF7\u586B\u5199\u767B\u5F55\u8D26\u53F7");else{let m={username:r};t.value.id>0&&(m=Object.assign({},m,{id:t.value.id}));const v=await ne(m);v.code==1&&d(v.message)}g(!0)})}]}}}),ie={class:W("arco-upload-list-item")},me={key:0,class:"arco-upload-list-picture custom-upload-avatar"},pe=["src"],fe={class:"arco-upload-list-picture-mask"},ce={key:1,class:"arco-upload-picture-card"},ge={class:"arco-upload-picture-card-text"},be=F("div",{style:{"margin-top":"10px","font-weight":"600"}},"\u4E0A\u4F20\u5934\u50CF",-1);function Be(e,u,R,f,D,V){const n=G,t=Q,s=Y,C=J,_=K,M=U("IconEdit"),w=U("IconPlus"),A=X,c=Z,I=x,S=U("BasicModal");return h(),H(S,N(e.$attrs,{onRegister:e.registerModal,loading:e.loading,helpMessage:"\u7F16\u8F91\u548C\u4FEE\u6539\u83DC\u5355",width:"800px",minHeight:450,title:e.getTitle,onOk:e.handleSubmit}),{default:o(()=>[a(I,{ref:"formRef",model:e.formData,"auto-label-width":""},{default:o(()=>[a(_,{gutter:16},{default:o(()=>[a(s,{span:12},{default:o(()=>[a(t,{field:"name",label:"\u7528\u6237\u59D3\u540D","validate-trigger":"input",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u7528\u6237\u59D3\u540D"}]},{default:o(()=>[a(n,{modelValue:e.formData.name,"onUpdate:modelValue":u[0]||(u[0]=l=>e.formData.name=l),placeholder:"\u8BF7\u586B\u7528\u6237\u59D3\u540D"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:o(()=>[a(t,{field:"nickname",label:"\u6635\u79F0","validate-trigger":"input"},{default:o(()=>[a(n,{modelValue:e.formData.nickname,"onUpdate:modelValue":u[1]||(u[1]=l=>e.formData.nickname=l),placeholder:"\u8BF7\u586B\u5199\u6635\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:o(()=>[a(t,{label:"\u9009\u62E9\u89D2\u8272",field:"pid"},{default:o(()=>[a(C,{placeholder:"\u9009\u62E9\u89D2\u8272",data:e.roleList,fieldNames:{key:"id",title:"name",children:"children"},multiple:"",modelValue:e.formData.roleid,"onUpdate:modelValue":u[2]||(u[2]=l=>e.formData.roleid=l)},null,8,["data","modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:o(()=>[a(t,{field:"username",label:"\u767B\u5F55\u8D26\u53F7",rules:e.usernameRules,"validate-trigger":["change","blur"]},{default:o(()=>[a(n,{modelValue:e.formData.username,"onUpdate:modelValue":u[3]||(u[3]=l=>e.formData.username=l),placeholder:"\u8BF7\u586B\u767B\u5F55\u8D26\u53F7"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),a(s,{span:12},{default:o(()=>[a(t,{field:"password",label:"\u767B\u5F55\u5BC6\u7801",style:{"margin-bottom":"15px"}},{default:o(()=>[a(n,{modelValue:e.formData.password,"onUpdate:modelValue":u[4]||(u[4]=l=>e.formData.password=l),placeholder:"\u767B\u5F55\u5BC6\u7801(\u4E0D\u4FEE\u6539\u5219\u4E3A\u7A7A\uFF0C\u9ED8\u8BA4\u5BC6\u7801123456)"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:o(()=>[a(t,{field:"mobile",label:"\u624B\u673A\u53F7\u7801",style:{"margin-bottom":"15px"}},{default:o(()=>[a(n,{t:"",modelValue:e.formData.mobile,"onUpdate:modelValue":u[5]||(u[5]=l=>e.formData.mobile=l),placeholder:"\u8BF7\u586B\u624B\u673A\u53F7\u7801"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:o(()=>[a(t,{field:"tel",label:"\u5EA7\u673A",style:{"margin-bottom":"15px"}},{default:o(()=>[a(n,{modelValue:e.formData.tel,"onUpdate:modelValue":u[6]||(u[6]=l=>e.formData.tel=l),placeholder:"\u8BF7\u586B\u5EA7\u673A"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:o(()=>[a(t,{field:"email",label:"\u90AE\u7BB1",style:{"margin-bottom":"15px"}},{default:o(()=>[a(n,{modelValue:e.formData.email,"onUpdate:modelValue":u[7]||(u[7]=l=>e.formData.email=l),placeholder:"\u8BF7\u586B\u90AE\u7BB1"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:o(()=>[a(t,{field:"address",label:"\u5730\u5740",style:{"margin-bottom":"15px"}},{default:o(()=>[a(n,{modelValue:e.formData.address,"onUpdate:modelValue":u[8]||(u[8]=l=>e.formData.address=l),placeholder:"\u8BF7\u586B\u5730\u5740"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:o(()=>[a(t,{field:"city",label:"\u57CE\u5E02",style:{"margin-bottom":"15px"}},{default:o(()=>[a(n,{modelValue:e.formData.city,"onUpdate:modelValue":u[9]||(u[9]=l=>e.formData.city=l),placeholder:"\u8BF7\u586B\u57CE\u5E02"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:o(()=>[a(t,{field:"company",label:"\u516C\u53F8",style:{"margin-bottom":"15px"}},{default:o(()=>[a(n,{modelValue:e.formData.company,"onUpdate:modelValue":u[10]||(u[10]=l=>e.formData.company=l),placeholder:"\u8BF7\u586B\u516C\u53F8"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(_,{gutter:16},{default:o(()=>[a(s,{span:12},{default:o(()=>[a(t,{field:"avatar",label:"\u5934\u50CF",style:{"margin-bottom":"15px"}},{default:o(()=>[a(A,{action:"/","show-file-list":!1,onChange:e.onChange,"custom-request":e.customRequest},{"upload-button":o(()=>[F("div",ie,[e.formData.avatar?(h(),L("div",me,[F("img",{src:e.formData.avatar},null,8,pe),F("div",fe,[a(M)])])):(h(),L("div",ce,[F("div",ge,[a(w),be])]))])]),_:1},8,["onChange","custom-request"])]),_:1})]),_:1}),a(s,{span:12},{default:o(()=>[a(t,{field:"remark",label:"\u5907\u6CE8",style:{"margin-bottom":"15px"}},{default:o(()=>[a(c,{modelValue:e.formData.remark,"onUpdate:modelValue":u[11]||(u[11]=l=>e.formData.remark=l),placeholder:"\u8BF7\u586B\u5907\u6CE8"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},16,["onRegister","loading","title","onOk"])}const Fe=T(de,[["render",Be]]),Te=Object.freeze(Object.defineProperty({__proto__:null,default:Fe},Symbol.toStringTag,{value:"Module"}));export{Fe as A,Te as a,Oe as d,ze as g,qe as u};
