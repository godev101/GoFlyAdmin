import{m as c,T as q,u as O,n as T,_ as $}from"./index.4e7f69e1.js";/* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css               *//* empty css                *//* empty css               *//* empty css               *//* empty css               */import{d as j,e as f,c as N,u as v,aS as U,aL as h,C as R,aE as H,aH as o,aI as a,G as D,D as L,bW as z,E as W,b6 as G,b7 as Q,bQ as Y,bL as J,bM as K,c2 as X,bR as Z,bc as x}from"./arco.f2539126.js";import{B as ee,u as ae}from"./index.d16c415d.js";import{u as oe}from"./loading.0b400085.js";import{g as te}from"./dept.1d473e65.js";import{I as le}from"./IconPicker.65a498b6.js";import{I as ue}from"./Icon.48da78a9.js";import{u as se}from"./common.d93fd641.js";function $e(e){return c.get({url:"/system/account/get_list",params:e},{errorMessageMode:"none"})}function re(){return c.get({url:"/system/account/get_role"},{errorMessageMode:"none"})}function ne(e){return e.password&&(e=Object.assign({},e,{password:q.exports(e.password)})),c.post({url:"/system/account/save",params:e},{errorMessageMode:"message"})}function de(e){return c.post({url:"/system/account/isaccountexist",params:e},{errorMessageMode:"message",isTransformResponse:!1})}function je(e){return c.post({url:"/system/account/upStatus",params:e},{errorMessageMode:"message"})}function Ne(e){return c.delete({url:"/system/account/del",params:e},{errorMessageMode:"message"})}const me=j({name:"AddBook",components:{BasicModal:ee,IconPicker:le,Icon:ue},emits:["success"],setup(e,{emit:t}){const{t:I}=O(),g=f(!1),y=f([]),V=f([]),n=f(),s={id:0,name:"",nickname:"",dept_id:0,roleid:[],username:"",password:"",avatar:"",tel:"",mobile:"",email:"",address:"",city:"",remark:"",company:""},u=f(s),E=f(""),[C,{setModalProps:w,closeModal:M}]=ae(async r=>{var p;(p=n.value)==null||p.resetFields(),w({confirmLoading:!1});const d=await re();d?y.value=d:y.value=[];const B=await te(),m=[{id:0,name:"\u672A\u9009\u90E8\u95E8",pid:0}];B?V.value=m.concat(B):V.value=m,g.value=!!(r!=null&&r.isUpdate),v(g)?(E.value=r.record.component,u.value=T(r.record)):u.value=s}),A=N(()=>v(g)?"\u7F16\u8F91\u7BA1\u7406\u8D26\u53F7":"\u65B0\u589E\u7BA1\u7406\u8D26\u53F7"),{loading:k,setLoading:b}=oe();return{registerModal:C,getTitle:A,handleSubmit:async()=>{var r;try{await((r=n.value)==null?void 0:r.validate())||(b(!0),!v(g)&&u.value.password==""&&(u.value.password="123456"),U.loading({content:"\u66F4\u65B0\u4E2D",id:"upStatus"}),await ne(v(u)),U.success({content:"\u66F4\u65B0\u6210\u529F",id:"upStatus"}),M(),t("success"),b(!1))}catch{b(!1),U.clear("top")}},formRef:n,loading:k,formData:u,roleList:y,deptList:V,t:I,OYoptions:[{label:"\u5426",value:0},{label:"\u662F",value:1}],onChange:r=>{console.log("fileList",r)},customRequest:r=>{const d=new AbortController;return async function(){const{onProgress:m,onError:p,onSuccess:Ee,fileItem:_}=r;m(20);const P=i=>{let F;i.total>0&&(F=i.loaded/i.total*100),m(parseInt(String(F),10),i)};try{const i=(_==null?void 0:_.name)||"",F=await se({name:"file",file:_.file,filename:i,data:{cid:0}},P);F&&(u.value.avatar=F.url)}catch(i){p(i)}}(),{abort(){d.abort()}}},usernameRules:[{validator:(r,d)=>new Promise(async B=>{if(!r)d("\u8BF7\u586B\u5199\u767B\u5F55\u8D26\u53F7");else{let m={username:r};u.value.id>0&&(m=Object.assign({},m,{id:u.value.id}));const p=await de(m);p.code==1&&d(p.message)}B(!0)})}]}}}),ie={class:W("arco-upload-list-item")},pe={key:0,class:"arco-upload-list-picture custom-upload-avatar"},fe=["src"],ce={class:"arco-upload-list-picture-mask"},ge={key:1,class:"arco-upload-picture-card"},be={class:"arco-upload-picture-card-text"},Be=D("div",{style:{"margin-top":"10px","font-weight":"600"}},"\u4E0A\u4F20\u5934\u50CF",-1);function Fe(e,t,I,g,y,V){const n=G,s=Q,u=Y,E=J,C=K,w=h("IconEdit"),M=h("IconPlus"),A=X,k=Z,b=x,S=h("BasicModal");return R(),H(S,z(e.$attrs,{onRegister:e.registerModal,loading:e.loading,helpMessage:"\u7F16\u8F91\u548C\u4FEE\u6539\u83DC\u5355",width:"800px",minHeight:420,title:e.getTitle,onOk:e.handleSubmit}),{default:o(()=>[a(b,{ref:"formRef",model:e.formData,"auto-label-width":""},{default:o(()=>[a(k,{gutter:16},{default:o(()=>[a(u,{span:12},{default:o(()=>[a(s,{field:"name",label:"\u7528\u6237\u540D","validate-trigger":"input",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u7528\u6237\u540D"}],style:{"margin-bottom":"15px"}},{default:o(()=>[a(n,{modelValue:e.formData.name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.formData.name=l),placeholder:"\u8BF7\u586B\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1})]),_:1}),a(u,{span:12},{default:o(()=>[a(s,{field:"nickname",label:"\u6635\u79F0","validate-trigger":"input",style:{"margin-bottom":"15px"}},{default:o(()=>[a(n,{modelValue:e.formData.nickname,"onUpdate:modelValue":t[1]||(t[1]=l=>e.formData.nickname=l),placeholder:"\u8BF7\u586B\u5199\u6635\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),a(u,{span:12},{default:o(()=>[a(s,{label:"\u9009\u62E9\u89D2\u8272",field:"pid",style:{"margin-bottom":"15px"}},{default:o(()=>[a(E,{placeholder:"\u9009\u62E9\u89D2\u8272",data:e.roleList,fieldNames:{key:"id",title:"name",children:"children"},multiple:"",modelValue:e.formData.roleid,"onUpdate:modelValue":t[2]||(t[2]=l=>e.formData.roleid=l)},null,8,["data","modelValue"])]),_:1})]),_:1}),a(u,{span:12},{default:o(()=>[a(s,{field:"dept_id",label:"\u9009\u62E9\u90E8\u95E8",style:{"margin-bottom":"15px"}},{default:o(()=>[a(E,{placeholder:"\u9009\u62E9\u90E8\u95E8",data:e.deptList,fieldNames:{key:"id",title:"name",children:"children"},modelValue:e.formData.dept_id,"onUpdate:modelValue":t[3]||(t[3]=l=>e.formData.dept_id=l)},null,8,["data","modelValue"])]),_:1})]),_:1}),a(u,{span:12},{default:o(()=>[a(s,{field:"username",label:"\u767B\u5F55\u8D26\u53F7",style:{"margin-bottom":"15px"},rules:e.usernameRules,"validate-trigger":["change","blur"]},{default:o(()=>[a(n,{modelValue:e.formData.username,"onUpdate:modelValue":t[4]||(t[4]=l=>e.formData.username=l),placeholder:"\u8BF7\u586B\u767B\u5F55\u8D26\u53F7"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),a(u,{span:12},{default:o(()=>[a(s,{field:"password",label:"\u767B\u5F55\u5BC6\u7801",style:{"margin-bottom":"15px"}},{default:o(()=>[a(n,{modelValue:e.formData.password,"onUpdate:modelValue":t[5]||(t[5]=l=>e.formData.password=l),placeholder:"\u767B\u5F55\u5BC6\u7801(\u4E0D\u4FEE\u6539\u5219\u4E3A\u7A7A\uFF0C\u9ED8\u8BA4\u5BC6\u7801123456)"},null,8,["modelValue"])]),_:1})]),_:1}),a(u,{span:12},{default:o(()=>[a(s,{field:"mobile",label:"\u624B\u673A\u53F7\u7801",style:{"margin-bottom":"15px"}},{default:o(()=>[a(n,{t:"",modelValue:e.formData.mobile,"onUpdate:modelValue":t[6]||(t[6]=l=>e.formData.mobile=l),placeholder:"\u8BF7\u586B\u624B\u673A\u53F7\u7801"},null,8,["modelValue"])]),_:1})]),_:1}),a(u,{span:12},{default:o(()=>[a(s,{field:"tel",label:"\u5EA7\u673A",style:{"margin-bottom":"15px"}},{default:o(()=>[a(n,{modelValue:e.formData.tel,"onUpdate:modelValue":t[7]||(t[7]=l=>e.formData.tel=l),placeholder:"\u8BF7\u586B\u5EA7\u673A"},null,8,["modelValue"])]),_:1})]),_:1}),a(u,{span:12},{default:o(()=>[a(s,{field:"email",label:"\u90AE\u7BB1",style:{"margin-bottom":"15px"}},{default:o(()=>[a(n,{modelValue:e.formData.email,"onUpdate:modelValue":t[8]||(t[8]=l=>e.formData.email=l),placeholder:"\u8BF7\u586B\u90AE\u7BB1"},null,8,["modelValue"])]),_:1})]),_:1}),a(u,{span:12},{default:o(()=>[a(s,{field:"address",label:"\u5730\u5740",style:{"margin-bottom":"15px"}},{default:o(()=>[a(n,{modelValue:e.formData.address,"onUpdate:modelValue":t[9]||(t[9]=l=>e.formData.address=l),placeholder:"\u8BF7\u586B\u5730\u5740"},null,8,["modelValue"])]),_:1})]),_:1}),a(u,{span:12},{default:o(()=>[a(s,{field:"city",label:"\u57CE\u5E02",style:{"margin-bottom":"15px"}},{default:o(()=>[a(n,{modelValue:e.formData.city,"onUpdate:modelValue":t[10]||(t[10]=l=>e.formData.city=l),placeholder:"\u8BF7\u586B\u57CE\u5E02"},null,8,["modelValue"])]),_:1})]),_:1}),a(u,{span:12},{default:o(()=>[a(s,{field:"company",label:"\u516C\u53F8",style:{"margin-bottom":"15px"}},{default:o(()=>[a(n,{modelValue:e.formData.company,"onUpdate:modelValue":t[11]||(t[11]=l=>e.formData.company=l),placeholder:"\u8BF7\u586B\u516C\u53F8"},null,8,["modelValue"])]),_:1})]),_:1}),a(u,{span:12},{default:o(()=>[a(s,{field:"remark",label:"\u5907\u6CE8",style:{"margin-bottom":"15px"}},{default:o(()=>[a(C,{modelValue:e.formData.remark,"onUpdate:modelValue":t[12]||(t[12]=l=>e.formData.remark=l),placeholder:"\u8BF7\u586B\u5907\u6CE8"},null,8,["modelValue"])]),_:1})]),_:1}),a(u,{span:12},{default:o(()=>[a(s,{field:"avatar",label:"\u5934\u50CF",style:{"margin-bottom":"15px"}},{default:o(()=>[a(A,{action:"/","show-file-list":!1,onChange:e.onChange,"custom-request":e.customRequest},{"upload-button":o(()=>[D("div",ie,[e.formData.avatar?(R(),L("div",pe,[D("img",{src:e.formData.avatar},null,8,fe),D("div",ce,[a(w)])])):(R(),L("div",ge,[D("div",be,[a(M),Be])]))])]),_:1},8,["onChange","custom-request"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},16,["onRegister","loading","title","onOk"])}const De=$(me,[["render",Fe]]),He=Object.freeze(Object.defineProperty({__proto__:null,default:De},Symbol.toStringTag,{value:"Module"}));export{De as A,He as a,Ne as d,$e as g,je as u};
